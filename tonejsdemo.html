<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Tone.js Playground</title>
    <!-- See https://tonejs.github.io/ for library details. -->
    <style type="text/css">
      .buttonUp {
        background-color: lightslategray;
        border-radius: 3px;
      }

      .buttonUp:hover,
      .buttonUp:focus {
        background-color: lightslategray;
        border-radius: 3px;
      }

      .buttonUp:focus {
        box-shadow: 0 0 0 4px rgba(0, 149, 255, .15);
      }

      .buttonUp:active {
        background-color: lightslategray;
        box-shadow: none;
        color: whitesmoke;
      }
      .buttonDown {
        background-color: lightslategray;
        border-radius: 3px;
        color: whitesmoke;
      }
    </style>
    <!-- Load Tone.js from cdnjs -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script type="text/javascript">
      // Define the synth engine
      function playNote(passedNoteValue) {
        const synth = new Tone.Synth().toDestination();
        var note = passedNoteValue; 
        synth.triggerAttackRelease(note, "32n");
      }

      // Set up keyboard event listeners
      document.addEventListener('keydown', (event)=> {    
          
          // reset the button colors
          const buttons = ['btnC4', 'btnD4', 'btnE4', 'btnF4', 'btnG4', 'btnA4', 'btnB4', 'btnC5'];
          buttons.forEach((buttonId) => {
            document.getElementById(buttonId).className = 'buttonUp';
          });

          // listen for keys, play notes, change button colors
          const notesMap = {
            a: "C4",
            s: "D4",
            d: "E4",
            f: "F4",
            g: "G4",
            h: "A4",
            j: "B4",
            k: "C5"
          };

          for (const [key, note] of Object.entries(notesMap)) {
            if (event.key === key) {
              playNote(note);
              document.getElementById(`btn${note}`).className = 'buttonDown';
              break;
            }
          }
          console.log("key pressed: " + event.key);
      });

      // Play a random chord with n=i notes
      function randomChord() {
        var allNotes = Array ("C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5"); 
        for (let i = 0; i < 4; i++) {
          var randomNote = allNotes[Math.floor(Math.random()*allNotes.length)];
          console.log("randomNote: " + randomNote);
          playNote(randomNote);
        }
      }

      // Play a random note
      function randomNote() {
        var allNotes = Array ("C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5"); 
          var randomNote = allNotes[Math.floor(Math.random()*allNotes.length)];
          console.log("randomNote: " + randomNote);
          playNote(randomNote);
      }

      // Play a random melody of n=i notes with n=theTimeout pauses between 
      function randomMelody() {
        var theTimeout = 0; 
        for (let i = 0; i < 4; i++) {
          setTimeout(() => randomNote(), theTimeout); 
          theTimeout = theTimeout + 1000; 
        }
      }

    </script>
  </head>
  <body>
    <input id="btnC4" class="buttonUp" type="button" value="C4" onclick="playNote(this.value);" />
    <input id="btnD4" class="buttonUp" type="button" value="D4" onclick="playNote(this.value);" />
    <input id="btnE4" class="buttonUp" type="button" value="E4" onclick="playNote(this.value);" />
    <input id="btnF4" class="buttonUp" type="button" value="F4" onclick="playNote(this.value);" />
    <input id="btnG4" class="buttonUp" type="button" value="G4" onclick="playNote(this.value);" />
    <input id="btnA4" class="buttonUp" type="button" value="A4" onclick="playNote(this.value);" />
    <input id="btnB4" class="buttonUp" type="button" value="B4" onclick="playNote(this.value);" />
    <input id="btnC5" class="buttonUp" type="button" value="C5" onclick="playNote(this.value);" />
    <input id="randomMelody" class="buttonUp" type="button" value="randomChord" onclick="randomChord()" />
    <input id="randomMelody" class="buttonUp" type="button" value="randomMelody" onclick="randomMelody()" />
  </body>
</html>
